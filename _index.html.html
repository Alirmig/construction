<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§ä¸šå·¥äººæ•ˆèƒ½å¯¹æ¯”åˆ†æç³»ç»Ÿ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; }
        body { background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%); color: #333; padding: 20px; min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #2c80b9; }
        h1 { color: #1a5f7a; margin-bottom: 10px; }
        .subtitle { color: #666; font-size: 1.1em; }
        .model-section { background: white; border-radius: 12px; padding: 25px; margin-bottom: 30px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08); border: 1px solid #e1e8ed; }
        h2 { color: #2c80b9; border-left: 5px solid #2c80b9; padding-left: 15px; margin-bottom: 20px; }
        .calculator-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        @media (max-width: 1024px) { .calculator-grid { grid-template-columns: 1fr; } }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #444; }
        input, select { width: 100%; padding: 12px 15px; border: 1px solid #ced4da; border-radius: 6px; font-size: 16px; transition: border-color 0.3s; }
        input:focus, select:focus { outline: none; border-color: #2c80b9; box-shadow: 0 0 0 3px rgba(44, 128, 185, 0.1); }
        .btn-group { display: flex; gap: 15px; margin-top: 25px; }
        button { flex: 1; padding: 14px 20px; background: #2c80b9; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        button:hover { background: #236fa3; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
        .secondary-btn { background: #6c757d; }
        .secondary-btn:hover { background: #5a6268; }
        .result-box { background: #f8f9fa; border-radius: 8px; padding: 20px; margin-top: 25px; border-left: 5px solid #28a745; }
        .result-title { font-size: 1.2em; font-weight: bold; margin-bottom: 15px; color: #1a5f7a; }
        .result-item { display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #dee2e6; }
        .result-label { font-weight: 600; }
        .result-value { font-weight: bold; color: #2c80b9; }
        .highlight { color: #28a745; font-size: 1.4em; }
        .chart-container { margin-top: 30px; height: 300px; }
        .data-storage { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 20px; margin-top: 30px; }
        .comparison-result { background: #e7f5ff; border-radius: 8px; padding: 20px; margin-top: 25px; }
        .comparison-title { font-size: 1.1em; font-weight: bold; margin-bottom: 15px; color: #1a5f7a; }
        .comparison-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .comparison-item { background: white; padding: 15px; border-radius: 6px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .footer-note { text-align: center; margin-top: 40px; color: #6c757d; font-size: 0.9em; padding-top: 20px; border-top: 1px solid #dee2e6; }
        /* æ–°å¢ï¼šå¯¹æ¯”è¡¨æ ¼æ ·å¼ */
        .comparison-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .comparison-table th, .comparison-table td { padding: 12px 15px; text-align: center; border: 1px solid #dee2e6; }
        .comparison-table th { background-color: #2c80b9; color: white; font-weight: 600; }
        .comparison-table tr:nth-child(even) { background-color: #f8f9fa; }
        .improvement { color: #28a745; font-weight: bold; }
        .regression { color: #dc3545; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ—ï¸ äº§ä¸šå·¥äººæ•ˆèƒ½ä¸æŠ•èµ„å¯¹æ¯”åˆ†æç³»ç»Ÿ</h1>
            <p class="subtitle">åŸºäºåŠ¨æ€è–ªèµ„ä¸é¡¹ç›®æ•ˆèƒ½å¯¹æ¯”çš„å·¥ç¨‹é€ ä»·åˆ†æå·¥å…·</p>
        </header>

        <div class="calculator-grid">
            <!-- å·¦ä¾§ï¼šåŠ¨æ€è–ªèµ„è®¡ç®—å™¨ï¼ˆå·²åˆ é™¤å­¦åˆ†å› ç´ ï¼‰ -->
            <section class="model-section">
                <h2>1. äº§ä¸šå·¥äººåŠ¨æ€è–ªèµ„è®¡ç®—æ¨¡å‹</h2>
                <p style="margin-bottom:20px; color:#666;">æ ¹æ®å·¥äººçš„æŠ€èƒ½å’Œç»©æ•ˆåŠ¨æ€è®¡ç®—å…¶å¸‚åœºå…¬å…ä»·å€¼ã€‚</p>
                
                <div class="input-group">
                    <label for="baseRate">åŸºç¡€å·¥ä»·ï¼ˆå…ƒ/å·¥æ—¥ï¼‰</label>
                    <input type="number" id="baseRate" min="0" value="280" placeholder="è¯·è¾“å…¥åŸºç¡€å·¥ä»·">
                    <small style="color:#6c757d; display:block; margin-top:5px;">å¯æ‰‹åŠ¨è¾“å…¥ä»»æ„å€¼ï¼Œå¦‚ï¼š280, 350, 400ç­‰</small>
                </div>

                <div class="input-group">
                    <label>æŠ€èƒ½æŒæ¡æƒ…å†µï¼ˆè¯·å¡«å†™æŒæ¡æ•°é‡ï¼‰</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 10px;">
                        <div>
                            <label for="basicSkills" style="font-size:0.9em;">åŸºç¡€æŠ€èƒ½</label>
                            <input type="number" id="basicSkills" min="0" value="2" placeholder="æ•°é‡">
                            <small style="color:#6c757d;">æ¯é¡¹åŠ æˆ0.05</small>
                        </div>
                        <div>
                            <label for="professionalSkills" style="font-size:0.9em;">ä¸“ä¸šæŠ€èƒ½</label>
                            <input type="number" id="professionalSkills" min="0" value="1" placeholder="æ•°é‡">
                            <small style="color:#6c757d;">æ¯é¡¹åŠ æˆ0.10</small>
                        </div>
                        <div>
                            <label for="advancedSkills" style="font-size:0.9em;">é«˜æ–°æŠ€æœ¯</label>
                            <input type="number" id="advancedSkills" min="0" value="0" placeholder="æ•°é‡">
                            <small style="color:#6c757d;">æ¯é¡¹åŠ æˆ0.15</small>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>ç»©æ•ˆè¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div>
                            <label for="efficiencyScore" style="font-size:0.9em;">å·¥ä½œæ•ˆç‡</label>
                            <input type="number" id="efficiencyScore" min="0" max="100" value="85">
                        </div>
                        <div>
                            <label for="qualityScore" style="font-size:0.9em;">å·¥ä½œè´¨é‡</label>
                            <input type="number" id="qualityScore" min="0" max="100" value="80">
                        </div>
                        <div>
                            <label for="safetyScore" style="font-size:0.9em;">å®‰å…¨è¡¨ç°</label>
                            <input type="number" id="safetyScore" min="0" max="100" value="90">
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button onclick="calculateDynamicSalary()">è®¡ç®—åŠ¨æ€è–ªèµ„</button>
                    <button class="secondary-btn" onclick="saveWorkerData()">ä¿å­˜æ­¤å·¥äººæ•°æ®</button>
                </div>

                <div id="salaryResult" class="result-box" style="display:none;">
                    <div class="result-title">åŠ¨æ€è–ªèµ„è®¡ç®—ç»“æœ</div>
                    <div class="result-item">
                        <span class="result-label">åŸºç¡€å·¥ä»·</span>
                        <span class="result-value" id="baseSalaryResult">0å…ƒ/å·¥æ—¥</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">æŠ€èƒ½ç³»æ•°</span>
                        <span class="result-value" id="skillCoefficientResult">1.00</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ç»©æ•ˆç³»æ•°</span>
                        <span class="result-value" id="performanceCoefficientResult">1.00</span>
                    </div>
                    <div class="result-item" style="border-bottom:none; padding-top:15px; border-top:2px solid #dee2e6;">
                        <span class="result-label">æœ€ç»ˆåŠ¨æ€è–ªèµ„</span>
                        <span class="result-value highlight" id="finalSalaryResult">0å…ƒ/å·¥æ—¥</span>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="salaryChart"></canvas>
                </div>
            </section>

            <!-- å³ä¾§ï¼šé¡¹ç›®æ•ˆèƒ½å¯¹æ¯”åˆ†æï¼ˆæ›¿æ¢åŸæŠ•èµ„å›æŠ¥æ¨¡å‹ï¼‰ -->
            <section class="model-section">
                <h2>2. é¡¹ç›®æ•ˆèƒ½å¯¹æ¯”åˆ†æ</h2>
                <p style="margin-bottom:20px; color:#666;">å¯¹æ¯”ä½¿ç”¨äº§ä¸šå·¥äººä¸ä¼ ç»Ÿæ¨¡å¼åœ¨é¡¹ç›®è´¨é‡ã€å®‰å…¨ã€å·¥æœŸä¸Šçš„å·®å¼‚ã€‚</p>
                
                <div class="input-group">
                    <label>é¡¹ç›®åŸºæœ¬æƒ…å†µ</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label for="projectName" style="font-size:0.9em;">é¡¹ç›®åç§°</label>
                            <input type="text" id="projectName" value="XXæ™ºæ…§äº§ä¸šå›­é¡¹ç›®">
                        </div>
                        <div>
                            <label for="projectValue" style="font-size:0.9em;">é¡¹ç›®æ€»é€ ä»·ï¼ˆä¸‡å…ƒï¼‰</label>
                            <input type="number" id="projectValue" min="0" value="5000">
                        </div>
                        <div>
                            <label for="workerCount" style="font-size:0.9em;">äº§ä¸šå·¥äººæ•°é‡</label>
                            <input type="number" id="workerCount" min="1" value="30">
                        </div>
                        <div>
                            <label for="projectDuration" style="font-size:0.9em;">è®¡åˆ’å·¥æœŸï¼ˆå¤©ï¼‰</label>
                            <input type="number" id="projectDuration" min="1" value="180">
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>æ”¶ç›Šå‚æ•°è®¡ç®—</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div>
                            <label for="efficiencyGain" style="font-size:0.9em;">äººå·¥æ•ˆç‡æå‡ (%)</label>
                            <input type="number" id="efficiencyGain" min="0" max="100" value="15">
                            <small style="color:#6c757d;">é¢„è®¡å€¼</small>
                        </div>
                        <div>
                            <label for="qualityGain" style="font-size:0.9em;">è´¨é‡æ•ˆç›Šæå‡ (%)</label>
                            <input type="number" id="qualityGain" min="0" max="100" value="20">
                            <small style="color:#6c757d;">è¿”å·¥ç‡é™ä½</small>
                        </div>
                        <div>
                            <label for="safetyGain" style="font-size:0.9em;">å®‰å…¨æ•ˆç›Šæå‡ (%)</label>
                            <input type="number" id="safetyGain" min="0" max="100" value="30">
                            <small style="color:#6c757d;">äº‹æ•…ç‡é™ä½</small>
                        </div>
                    </div>
                </div>

                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <h3 style="color: #1a5f7a; margin-bottom: 15px;">é¡¹ç›®æ•°æ®å¯¹æ¯”è¾“å…¥</h3>
                    
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>å¯¹æ¯”æŒ‡æ ‡</th>
                                <th>ä¼ ç»Ÿé¡¹ç›® (æœªä½¿ç”¨äº§ä¸šå·¥äºº)</th>
                                <th>æœ¬é¡¹ç›® (ä½¿ç”¨äº§ä¸šå·¥äºº)</th>
                                <th>å•ä½</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ä¸€æ¬¡éªŒæ”¶åˆæ ¼ç‡</td>
                                <td><input type="number" id="traditionalQuality" min="0" max="100" value="85" style="width:100%;"> %</td>
                                <td><input type="number" id="newQuality" min="0" max="100" value="94" style="width:100%;"> %</td>
                                <td>ç™¾åˆ†æ¯”</td>
                            </tr>
                            <tr>
                                <td>å®‰å…¨äº‹æ•…æ¬¡æ•°</td>
                                <td><input type="number" id="traditionalSafety" min="0" value="3" style="width:100%;"> æ¬¡</td>
                                <td><input type="number" id="newSafety" min="0" value="1" style="width:100%;"> æ¬¡</td>
                                <td>æ¬¡æ•°</td>
                            </tr>
                            <tr>
                                <td>å¹³å‡è¿”å·¥ç‡</td>
                                <td><input type="number" id="traditionalRework" min="0" max="100" value="8" style="width:100%;"> %</td>
                                <td><input type="number" id="newRework" min="0" max="100" value="3" style="width:100%;"> %</td>
                                <td>ç™¾åˆ†æ¯”</td>
                            </tr>
                            <tr>
                                <td>é¡¹ç›®å·¥æœŸ</td>
                                <td><input type="number" id="traditionalDuration" min="1" value="190" style="width:100%;"> å¤©</td>
                                <td><input type="number" id="newDuration" min="1" value="175" style="width:100%;"> å¤©</td>
                                <td>å¤©æ•°</td>
                            </tr>
                            <tr>
                                <td>å®¢æˆ·æ»¡æ„åº¦è¯„åˆ†</td>
                                <td><input type="number" id="traditionalSatisfaction" min="0" max="5" value="3.8" step="0.1" style="width:100%;"> åˆ†</td>
                                <td><input type="number" id="newSatisfaction" min="0" max="5" value="4.5" step="0.1" style="width:100%;"> åˆ†</td>
                                <td>5åˆ†åˆ¶</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="btn-group">
                    <button onclick="calculateProjectComparison()">ç”Ÿæˆæ•ˆèƒ½å¯¹æ¯”æŠ¥å‘Š</button>
                    <button class="secondary-btn" onclick="resetProjectComparison()">é‡ç½®æ•°æ®</button>
                </div>

                <div id="projectResult" class="result-box" style="display:none;">
                    <div class="result-title" id="projectResultTitle">é¡¹ç›®æ•ˆèƒ½å¯¹æ¯”åˆ†æç»“æœ</div>
                    <div id="projectResultContent">
                        <!-- åŠ¨æ€ç”Ÿæˆå¯¹æ¯”ç»“æœ -->
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </section>
        </div>

        <!-- æ•°æ®å­˜å‚¨ä¸å¯¹æ¯”åŒºåŸŸ -->
        <div class="data-storage">
            <h3>ğŸ“Š å·¥äººæ•°æ®å­˜å‚¨ä¸å¯¹æ¯”åˆ†æ</h3>
            <p>å·²ä¿å­˜çš„å·¥äººæ•°æ®å°†åœ¨æ­¤æ˜¾ç¤ºï¼Œå¯ç”¨äºå¤šæ–¹æ¡ˆæ¯”è¾ƒã€‚</p>
            <div id="storedWorkers" style="margin-top:15px; min-height:60px; padding:10px; background:#f8f9fa; border-radius:5px;">
                <p style="color:#999; text-align:center;">æš‚æ— ä¿å­˜çš„å·¥äººæ•°æ®</p>
            </div>
            <div class="btn-group" style="margin-top:15px;">
                <button onclick="compareWorkers()" style="background:#17a2b8;">å¯¹æ¯”é€‰ä¸­å·¥äºº</button>
                <button onclick="clearWorkerData()" class="secondary-btn">æ¸…ç©ºæ•°æ®</button>
            </div>
            <div id="comparisonResult" class="comparison-result" style="display:none;"></div>
        </div>

        <div class="footer-note">
            <p>Â© 2024 å·¥ç¨‹é€ ä»·ä¸“ä¸š - å»ºç­‘äº§ä¸šå·¥äººæ•°å­—åŒ–è½¬å‹ç ”ç©¶é¡¹ç›® | æ•ˆèƒ½å¯¹æ¯”åˆ†æç³»ç»Ÿ</p>
            <p style="margin-top:5px; font-size:0.85em;">æç¤ºï¼šæ‰€æœ‰è®¡ç®—ç»“æœåŸºäºè¾“å…¥å‚æ•°ä¼°ç®—ï¼Œå®é™…åº”ç”¨æ—¶éœ€æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œæ ¡å‡†ã€‚</p>
        </div>
    </div>

    <script>
        // å­˜å‚¨å·¥äººæ•°æ®çš„æ•°ç»„
        let storedWorkers = [];
        let salaryChart = null;
        let comparisonChart = null;

        // åŠ¨æ€è–ªèµ„è®¡ç®—å‡½æ•°ï¼ˆå·²åˆ é™¤å­¦åˆ†å› ç´ ï¼‰
        function calculateDynamicSalary() {
            // è·å–è¾“å…¥å€¼
            const baseRate = parseFloat(document.getElementById('baseRate').value) || 280;
            const basicSkills = parseInt(document.getElementById('basicSkills').value) || 0;
            const professionalSkills = parseInt(document.getElementById('professionalSkills').value) || 0;
            const advancedSkills = parseInt(document.getElementById('advancedSkills').value) || 0;
            const efficiencyScore = parseInt(document.getElementById('efficiencyScore').value) || 0;
            const qualityScore = parseInt(document.getElementById('qualityScore').value) || 0;
            const safetyScore = parseInt(document.getElementById('safetyScore').value) || 0;

            // è®¡ç®—æŠ€èƒ½ç³»æ•°
            const skillCoefficient = 1 + (basicSkills * 0.05) + (professionalSkills * 0.10) + (advancedSkills * 0.15);
            
            // è®¡ç®—ç»©æ•ˆç³»æ•°
            const performanceScore = (efficiencyScore * 0.4) + (qualityScore * 0.4) + (safetyScore * 0.2);
            let performanceCoefficient;
            if (performanceScore >= 90) performanceCoefficient = 1.2;
            else if (performanceScore >= 80) performanceCoefficient = 1.1;
            else if (performanceScore >= 70) performanceCoefficient = 1.0;
            else performanceCoefficient = 0.9;

            // è®¡ç®—æœ€ç»ˆåŠ¨æ€è–ªèµ„ï¼ˆå·²åˆ é™¤å­¦åˆ†ç³»æ•°ï¼‰
            const finalSalary = baseRate * skillCoefficient * performanceCoefficient;

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('baseSalaryResult').textContent = `${baseRate.toFixed(2)}å…ƒ/å·¥æ—¥`;
            document.getElementById('skillCoefficientResult').textContent = skillCoefficient.toFixed(3);
            document.getElementById('performanceCoefficientResult').textContent = performanceCoefficient.toFixed(3);
            document.getElementById('finalSalaryResult').textContent = `${finalSalary.toFixed(2)}å…ƒ/å·¥æ—¥`;
            document.getElementById('salaryResult').style.display = 'block';

            // æ›´æ–°å›¾è¡¨
            updateSalaryChart(baseRate, skillCoefficient, performanceCoefficient, finalSalary);

            return {
                baseRate,
                skillCoefficient,
                performanceCoefficient,
                finalSalary,
                performanceScore
            };
        }

        // é¡¹ç›®æ•ˆèƒ½å¯¹æ¯”è®¡ç®—å‡½æ•°
        function calculateProjectComparison() {
            // è·å–åŸºæœ¬ä¿¡æ¯
            const projectName = document.getElementById('projectName').value;
            const projectValue = parseFloat(document.getElementById('projectValue').value) || 0;
            const workerCount = parseInt(document.getElementById('workerCount').value) || 0;
            const projectDuration = parseInt(document.getElementById('projectDuration').value) || 0;
            
            // è·å–æ”¶ç›Šå‚æ•°
            const efficiencyGain = parseFloat(document.getElementById('efficiencyGain').value) || 0;
            const qualityGain = parseFloat(document.getElementById('qualityGain').value) || 0;
            const safetyGain = parseFloat(document.getElementById('safetyGain').value) || 0;
            
            // è·å–å¯¹æ¯”æ•°æ®
            const traditionalQuality = parseFloat(document.getElementById('traditionalQuality').value) || 0;
            const newQuality = parseFloat(document.getElementById('newQuality').value) || 0;
            const traditionalSafety = parseFloat(document.getElementById('traditionalSafety').value) || 0;
            const newSafety = parseFloat(document.getElementById('newSafety').value) || 0;
            const traditionalRework = parseFloat(document.getElementById('traditionalRework').value) || 0;
            const newRework = parseFloat(document.getElementById('newRework').value) || 0;
            const traditionalDuration = parseFloat(document.getElementById('traditionalDuration').value) || 0;
            const newDuration = parseFloat(document.getElementById('newDuration').value) || 0;
            const traditionalSatisfaction = parseFloat(document.getElementById('traditionalSatisfaction').value) || 0;
            const newSatisfaction = parseFloat(document.getElementById('newSatisfaction').value) || 0;
            
            // è®¡ç®—å„é¡¹æ”¹å–„æŒ‡æ ‡
            const qualityImprovement = newQuality - traditionalQuality;
            const safetyImprovement = traditionalSafety - newSafety; // äº‹æ•…æ¬¡æ•°å‡å°‘
            const reworkImprovement = traditionalRework - newRework; // è¿”å·¥ç‡é™ä½
            const durationImprovement = traditionalDuration - newDuration; // å·¥æœŸç¼©çŸ­
            const satisfactionImprovement = newSatisfaction - traditionalSatisfaction;
            
            // è®¡ç®—é‡åŒ–æ”¶ç›Šï¼ˆç¤ºä¾‹è®¡ç®—é€»è¾‘ï¼‰
            const dailyCost = 5000; // å‡è®¾æ¯æ—¥ç»¼åˆæˆæœ¬5000å…ƒ
            const accidentCost = 20000; // å‡è®¾æ¯æ¬¡äº‹æ•…å¹³å‡æˆæœ¬20000å…ƒ
            const reworkCostRate = 0.3; // è¿”å·¥æˆæœ¬å æ€»é€ ä»·æ¯”ä¾‹
            
            const efficiencyBenefit = projectValue * 10000 * (efficiencyGain / 100) * 0.1; // æ•ˆç‡æå‡æ”¶ç›Šä¼°ç®—
            const qualityBenefit = projectValue * 10000 * (reworkImprovement / 100) * reworkCostRate;
            const safetyBenefit = safetyImprovement * accidentCost;
            const durationBenefit = durationImprovement * dailyCost;
            
            const totalQuantifiableBenefit = efficiencyBenefit + qualityBenefit + safetyBenefit + durationBenefit;
            
            // ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š
            let reportHtml = `
                <h4 style="color:#1a5f7a; margin-bottom:15px;">${projectName} - æ•ˆèƒ½å¯¹æ¯”åˆ†æ</h4>
                
                <div class="result-item">
                    <span class="result-label">é¡¹ç›®æ€»é€ ä»·</span>
                    <span class="result-value">${projectValue.toFixed(2)} ä¸‡å…ƒ</span>
                </div>
                
                <div style="margin: 20px 0; padding: 15px; background: #f0f8ff; border-radius: 6px;">
                    <h5 style="color: #2c80b9; margin-bottom: 10px;">é‡åŒ–æ”¶ç›Šä¼°ç®—</h5>
                    <div class="result-item">
                        <span class="result-label">äººå·¥æ•ˆç‡æå‡æ”¶ç›Š</span>
                        <span class="result-value">${efficiencyBenefit.toFixed(2)} å…ƒ</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">è´¨é‡æ•ˆç›Šï¼ˆè¿”å·¥å‡å°‘ï¼‰</span>
                        <span class="result-value">${qualityBenefit.toFixed(2)} å…ƒ</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">å®‰å…¨æ•ˆç›Šï¼ˆäº‹æ•…å‡å°‘ï¼‰</span>
                        <span class="result-value">${safetyBenefit.toFixed(2)} å…ƒ</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">å·¥æœŸèŠ‚çº¦æ•ˆç›Š</span>
                        <span class="result-value">${durationBenefit.toFixed(2)} å…ƒ</span>
                    </div>
                    <div class="result-item" style="border-top: 2px solid #2c80b9; padding-top: 10px;">
                        <span class="result-label">å¯é‡åŒ–æ€»æ•ˆç›Š</span>
                        <span class="result-value highlight">${totalQuantifiableBenefit.toFixed(2)} å…ƒ</span>
                    </div>
                </div>
                
                <h5 style="color: #2c80b9; margin: 20px 0 10px 0;">å…³é”®æŒ‡æ ‡å¯¹æ¯”è¯¦æƒ…</h5>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>å…³é”®æŒ‡æ ‡</th>
                            <th>ä¼ ç»Ÿé¡¹ç›®</th>
                            <th>äº§ä¸šå·¥äººé¡¹ç›®</th>
                            <th>æ”¹å–„æƒ…å†µ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ä¸€æ¬¡éªŒæ”¶åˆæ ¼ç‡</td>
                            <td>${traditionalQuality}%</td>
                            <td>${newQuality}%</td>
                            <td class="${qualityImprovement > 0 ? 'improvement' : 'regression'}">${qualityImprovement > 0 ? '+' : ''}${qualityImprovement.toFixed(1)}%</td>
                        </tr>
                        <tr>
                            <td>å®‰å…¨äº‹æ•…æ¬¡æ•°</td>
                            <td>${traditionalSafety} æ¬¡</td>
                            <td>${newSafety} æ¬¡</td>
                            <td class="${safetyImprovement > 0 ? 'improvement' : 'regression'}">${safetyImprovement > 0 ? 'å‡å°‘' : 'å¢åŠ '} ${Math.abs(safetyImprovement)} æ¬¡</td>
                        </tr>
                        <tr>
                            <td>å¹³å‡è¿”å·¥ç‡</td>
                            <td>${traditionalRework}%</td>
                            <td>${newRework}%</td>
                            <td class="${reworkImprovement > 0 ? 'improvement' : 'regression'}">${reworkImprovement > 0 ? 'é™ä½' : 'å¢åŠ '} ${Math.abs(reworkImprovement.toFixed(1))}%</td>
                        </tr>
                        <tr>
                            <td>é¡¹ç›®å·¥æœŸ</td>
                            <td>${traditionalDuration} å¤©</td>
                            <td>${newDuration} å¤©</td>
                            <td class="${durationImprovement > 0 ? 'improvement' : 'regression'}">${durationImprovement > 0 ? 'ç¼©çŸ­' : 'å»¶é•¿'} ${Math.abs(durationImprovement)} å¤©</td>
                        </tr>
                        <tr>
                            <td>å®¢æˆ·æ»¡æ„åº¦</td>
                            <td>${traditionalSatisfaction.toFixed(1)} / 5åˆ†</td>
                            <td>${newSatisfaction.toFixed(1)} / 5åˆ†</td>
                            <td class="${satisfactionImprovement > 0 ? 'improvement' : 'regression'}">${satisfactionImprovement > 0 ? 'æå‡' : 'ä¸‹é™'} ${Math.abs(satisfactionImprovement.toFixed(1))} åˆ†</td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 6px;">
                    <h5 style="color: #856404; margin-bottom: 10px;">åˆ†æç»“è®º</h5>
                    <p>é‡‡ç”¨äº§ä¸šå·¥äººæ¨¡å¼åï¼Œé¡¹ç›®åœ¨ <strong>${Object.entries({
                        'è´¨é‡': qualityImprovement,
                        'å®‰å…¨': safetyImprovement,
                        'å·¥æœŸ': durationImprovement,
                        'å®¢æˆ·æ»¡æ„åº¦': satisfactionImprovement
                    }).filter(([_, val]) => val > 0).map(([key, val]) => key).join('ã€')}</strong> ç­‰æ–¹é¢å‡æœ‰æ˜¾è‘—æ”¹å–„ã€‚</p>
                    <p>æŒ‰ç…§å½“å‰å‚æ•°ä¼°ç®—ï¼Œæœ¬é¡¹ç›®å¯é‡åŒ–çš„ç»¼åˆæ•ˆç›Šçº¦ä¸º <strong>${(totalQuantifiableBenefit / 10000).toFixed(2)} ä¸‡å…ƒ</strong>ã€‚</p>
                </div>
            `;
            
            document.getElementById('projectResultContent').innerHTML = reportHtml;
            document.getElementById('projectResultTitle').textContent = `${projectName} - æ•ˆèƒ½å¯¹æ¯”åˆ†æç»“æœ`;
            document.getElementById('projectResult').style.display = 'block';
            
            // æ›´æ–°å¯¹æ¯”å›¾è¡¨
            updateComparisonChart(
                traditionalQuality, newQuality,
                traditionalSafety, newSafety,
                traditionalRework, newRework,
                traditionalDuration, newDuration,
                traditionalSatisfaction, newSatisfaction
            );
            
            return {
                projectName,
                qualityImprovement,
                safetyImprovement,
                reworkImprovement,
                durationImprovement,
                satisfactionImprovement,
                totalQuantifiableBenefit
            };
        }

        // ä¿å­˜å·¥äººæ•°æ®
        function saveWorkerData() {
            const salaryResult = calculateDynamicSalary();
            const baseRate = document.getElementById('baseRate').value;
            
            const workerData = {
                id: Date.now(),
                name: `è‡ªå®šä¹‰å·¥äººï¼ˆ${baseRate}å…ƒ/æ—¥ï¼‰`,
                timestamp: new Date().toLocaleString(),
                baseRate: salaryResult.baseRate,
                skillCoefficient: salaryResult.skillCoefficient,
                performanceCoefficient: salaryResult.performanceCoefficient,
                finalSalary: salaryResult.finalSalary,
                performanceScore: salaryResult.performanceScore,
                basicSkills: parseInt(document.getElementById('basicSkills').value) || 0,
                professionalSkills: parseInt(document.getElementById('professionalSkills').value) || 0,
                advancedSkills: parseInt(document.getElementById('advancedSkills').value) || 0
            };

            storedWorkers.push(workerData);
            updateStoredWorkersDisplay();
            
            alert(`å·¥äººæ•°æ®å·²ä¿å­˜ï¼\nå·¥ç§ï¼š${workerData.name}\nåŠ¨æ€è–ªèµ„ï¼š${workerData.finalSalary.toFixed(2)}å…ƒ/å·¥æ—¥`);
        }

        // æ›´æ–°å­˜å‚¨çš„å·¥äººæ•°æ®æ˜¾ç¤º
        function updateStoredWorkersDisplay() {
            const container = document.getElementById('storedWorkers');
            
            if (storedWorkers.length === 0) {
                container.innerHTML = '<p style="color:#999; text-align:center;">æš‚æ— ä¿å­˜çš„å·¥äººæ•°æ®</p>';
                return;
            }

            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">';
            
            storedWorkers.forEach((worker, index) => {
                html += `
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #dee2e6;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>${worker.name}</strong>
                            <small>${worker.timestamp}</small>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span>åŸºç¡€å·¥ä»·: ${worker.baseRate.toFixed(2)}å…ƒ</span> | 
                            <span>åŠ¨æ€è–ªèµ„: <strong>${worker.finalSalary.toFixed(2)}å…ƒ</strong></span>
                        </div>
                        <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;">
                            æŠ€èƒ½: ${worker.basicSkills}+${worker.professionalSkills}+${worker.advancedSkills} | 
                            ç»©æ•ˆ: ${worker.performanceScore.toFixed(1)}åˆ†
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <label style="font-size: 0.85em;">
                                <input type="checkbox" class="compare-checkbox" value="${worker.id}"> å¯¹æ¯”
                            </label>
                            <button onclick="deleteWorker(${worker.id})" style="background: #dc3545; color: white; border: none; padding: 3px 8px; border-radius: 3px; font-size: 0.85em; cursor: pointer;">åˆ é™¤</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // åˆ é™¤å·¥äººæ•°æ®
        function deleteWorker(id) {
            storedWorkers = storedWorkers.filter(worker => worker.id !== id);
            updateStoredWorkersDisplay();
        }

        // å¯¹æ¯”å·¥äººæ•°æ®
        function compareWorkers() {
            const checkboxes = document.querySelectorAll('.compare-checkbox:checked');
            
            if (checkboxes.length < 2) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸¤åå·¥äººè¿›è¡Œå¯¹æ¯”ï¼');
                return;
            }

            const selectedIds = Array.from(checkboxes).map(cb => parseInt(cb.value));
            const selectedWorkers = storedWorkers.filter(worker => selectedIds.includes(worker.id));
            
            let comparisonHtml = `
                <div class="comparison-title">å·¥äººè–ªèµ„å¯¹æ¯”åˆ†æ</div>
                <div class="comparison-grid">
            `;

            selectedWorkers.forEach(worker => {
                comparisonHtml += `
                    <div class="comparison-item">
                        <div style="font-weight: bold; margin-bottom: 10px;">${worker.name}</div>
                        <div style="font-size: 1.5em; color: #2c80b9; margin-bottom: 10px;">${worker.finalSalary.toFixed(2)}å…ƒ</div>
                        <div style="font-size: 0.9em; color: #666;">
                            <div>åŸºç¡€: ${worker.baseRate.toFixed(2)}å…ƒ</div>
                            <div>æŠ€èƒ½ç³»æ•°: ${worker.skillCoefficient.toFixed(3)}</div>
                            <div>ç»©æ•ˆç³»æ•°: ${worker.performanceCoefficient.toFixed(3)}</div>
                        </div>
                    </div>
                `;
            });

            comparisonHtml += '</div>';
            
            // è®¡ç®—å¹³å‡å€¼
            const avgSalary = selectedWorkers.reduce((sum, w) => sum + w.finalSalary, 0) / selectedWorkers.length;
            const maxSalary = Math.max(...selectedWorkers.map(w => w.finalSalary));
            const minSalary = Math.min(...selectedWorkers.map(w => w.finalSalary));
            
            comparisonHtml += `
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">
                        <div>
                            <div style="font-size: 0.9em; color: #666;">å¹³å‡è–ªèµ„</div>
                            <div style="font-size: 1.2em; font-weight: bold;">${avgSalary.toFixed(2)}å…ƒ</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9em; color: #666;">æœ€é«˜è–ªèµ„</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #28a745;">${maxSalary.toFixed(2)}å…ƒ</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9em; color: #666;">æœ€ä½è–ªèµ„</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #dc3545;">${minSalary.toFixed(2)}å…ƒ</div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('comparisonResult').innerHTML = comparisonHtml;
            document.getElementById('comparisonResult').style.display = 'block';
        }

        // æ¸…ç©ºå·¥äººæ•°æ®
        function clearWorkerData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ä¿å­˜çš„å·¥äººæ•°æ®å—ï¼Ÿ')) {
                storedWorkers = [];
                updateStoredWorkersDisplay();
                document.getElementById('comparisonResult').style.display = 'none';
            }
        }

        // é‡ç½®é¡¹ç›®å¯¹æ¯”æ•°æ®
        function resetProjectComparison() {
            document.getElementById('projectName').value = 'XXæ™ºæ…§äº§ä¸šå›­é¡¹ç›®';
            document.getElementById('projectValue').value = '5000';
            document.getElementById('workerCount').value = '30';
            document.getElementById('projectDuration').value = '180';
            document.getElementById('efficiencyGain').value = '15';
            document.getElementById('qualityGain').value = '20';
            document.getElementById('safetyGain').value = '30';
            document.getElementById('traditionalQuality').value = '85';
            document.getElementById('newQuality').value = '94';
            document.getElementById('traditionalSafety').value = '3';
            document.getElementById('newSafety').value = '1';
            document.getElementById('traditionalRework').value = '8';
            document.getElementById('newRework').value = '3';
            document.getElementById('traditionalDuration').value = '190';
            document.getElementById('newDuration').value = '175';
            document.getElementById('traditionalSatisfaction').value = '3.8';
            document.getElementById('newSatisfaction').value = '4.5';
            document.getElementById('projectResult').style.display = 'none';
            
            if (comparisonChart) {
                comparisonChart.destroy();
            }
        }

        // æ›´æ–°è–ªèµ„å›¾è¡¨
        function updateSalaryChart(baseRate, skillCoefficient, performanceCoefficient, finalSalary) {
            const ctx = document.getElementById('salaryChart').getContext('2d');
            
            if (salaryChart) {
                salaryChart.destroy();
            }

            salaryChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['åŸºç¡€å·¥ä»·', 'æŠ€èƒ½ç³»æ•°å½±å“', 'ç»©æ•ˆç³»æ•°å½±å“', 'æœ€ç»ˆåŠ¨æ€è–ªèµ„'],
                    datasets: [{
                        label: 'é‡‘é¢/ç³»æ•°å€¼',
                        data: [
                            baseRate,
                            (skillCoefficient - 1) * 100, // è½¬æ¢ä¸ºç™¾åˆ†æ¯”å½±å“
                            (performanceCoefficient - 1) * 100,
                            finalSalary
                        ],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(40, 167, 69, 0.7)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(40, 167, 69, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'é‡‘é¢(å…ƒ) / å½±å“ç™¾åˆ†æ¯”(%)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataIndex < 3) {
                                        label += context.parsed.y.toFixed(2);
                                        if (context.dataIndex > 0) {
                                            label += '%';
                                        }
                                    } else {
                                        label += context.parsed.y.toFixed(2) + 'å…ƒ';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // æ›´æ–°å¯¹æ¯”å›¾è¡¨
        function updateComparisonChart(traditionalQuality, newQuality, traditionalSafety, newSafety, 
                                      traditionalRework, newRework, traditionalDuration, newDuration,
                                      traditionalSatisfaction, newSatisfaction) {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            
            if (comparisonChart) {
                comparisonChart.destroy();
            }

            // å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ä»¥ä¾¿äºæ¯”è¾ƒ
            const maxQuality = Math.max(traditionalQuality, newQuality);
            const maxSafety = Math.max(traditionalSafety, newSafety);
            const maxRework = Math.max(traditionalRework, newRework);
            const maxDuration = Math.max(traditionalDuration, newDuration);
            const maxSatisfaction = Math.max(traditionalSatisfaction, newSatisfaction);
            
            // æ³¨æ„ï¼šå®‰å…¨æŒ‡æ ‡ï¼ˆäº‹æ•…æ¬¡æ•°ï¼‰å’Œè¿”å·¥ç‡æ˜¯è¶Šä½è¶Šå¥½ï¼Œæ‰€ä»¥å–å€’æ•°
            const normalizedTraditionalSafety = maxSafety > 0 ? (maxSafety - traditionalSafety + 1) / maxSafety * 100 : 0;
            const normalizedNewSafety = maxSafety > 0 ? (maxSafety - newSafety + 1) / maxSafety * 100 : 0;
            const normalizedTraditionalRework = maxRework > 0 ? (maxRework - traditionalRework + 1) / maxRework * 100 : 0;
            const normalizedNewRework = maxRework > 0 ? (maxRework - newRework + 1) / maxRework * 100 : 0;
            const normalizedTraditionalDuration = maxDuration > 0 ? (maxDuration - traditionalDuration + 1) / maxDuration * 100 : 0;
            const normalizedNewDuration = maxDuration > 0 ? (maxDuration - newDuration + 1) / maxDuration * 100 : 0;

            comparisonChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['ä¸€æ¬¡éªŒæ”¶åˆæ ¼ç‡', 'å®‰å…¨è¡¨ç°', 'è¿”å·¥æ§åˆ¶', 'å·¥æœŸæ•ˆç‡', 'å®¢æˆ·æ»¡æ„åº¦'],
                    datasets: [
                        {
                            label: 'ä¼ ç»Ÿé¡¹ç›®',
                            data: [
                                traditionalQuality,
                                normalizedTraditionalSafety,
                                normalizedTraditionalRework,
                                normalizedTraditionalDuration,
                                traditionalSatisfaction * 20 // è½¬æ¢ä¸ºç™¾åˆ†æ¯”ï¼ˆ5åˆ†åˆ¶è½¬100åˆ†ï¼‰
                            ],
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                        },
                        {
                            label: 'äº§ä¸šå·¥äººé¡¹ç›®',
                            data: [
                                newQuality,
                                normalizedNewSafety,
                                normalizedNewRework,
                                normalizedNewDuration,
                                newSatisfaction * 20 // è½¬æ¢ä¸ºç™¾åˆ†æ¯”ï¼ˆ5åˆ†åˆ¶è½¬100åˆ†ï¼‰
                            ],
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(54, 162, 235, 1)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    let value = context.raw;
                                    let suffix = '%';
                                    
                                    // æ ¹æ®æŒ‡æ ‡ç±»å‹è°ƒæ•´æ˜¾ç¤º
                                    const index = context.dataIndex;
                                    if (index === 0) { // åˆæ ¼ç‡
                                        suffix = '%';
                                    } else if (index === 1) { // å®‰å…¨è¡¨ç°
                                        const originalValue = context.datasetIndex === 0 ? 
                                            traditionalSafety : newSafety;
                                        return `${label}: ${originalValue} æ¬¡äº‹æ•…`;
                                    } else if (index === 2) { // è¿”å·¥æ§åˆ¶
                                        const originalValue = context.datasetIndex === 0 ? 
                                            traditionalRework : newRework;
                                        return `${label}: ${originalValue}% è¿”å·¥ç‡`;
                                    } else if (index === 3) { // å·¥æœŸæ•ˆç‡
                                        const originalValue = context.datasetIndex === 0 ? 
                                            traditionalDuration : newDuration;
                                        return `${label}: ${originalValue} å¤©`;
                                    } else if (index === 4) { // å®¢æˆ·æ»¡æ„åº¦
                                        const originalValue = context.datasetIndex === 0 ? 
                                            traditionalSatisfaction : newSatisfaction;
                                        return `${label}: ${originalValue.toFixed(1)} / 5åˆ†`;
                                    }
                                    
                                    return `${label}: ${value.toFixed(1)}${suffix}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹è®¡ç®—ä¸€æ¬¡ä»¥æ˜¾ç¤ºå›¾è¡¨
            calculateDynamicSalary();
            setTimeout(calculateProjectComparison, 100);
        });
    </script>
</body>
</html>